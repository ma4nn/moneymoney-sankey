<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <title>Cashflow Chart {{ start_date }} bis {{ end_date }}</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3C!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--%3E%3Cpath fill='%23304f5f' d='M304 240l0-223.4c0-9 7-16.6 16-16.6C443.7 0 544 100.3 544 224c0 9-7.6 16-16.6 16L304 240zM32 272C32 150.7 122.1 50.3 239 34.3c9.2-1.3 17 6.1 17 15.4L256 288 412.5 444.5c6.7 6.7 6.2 17.7-1.5 23.1C371.8 495.6 323.8 512 272 512C139.5 512 32 404.6 32 272zm526.4 16c9.3 0 16.6 7.8 15.4 17c-7.7 55.9-34.6 105.6-73.9 142.3c-6 5.6-15.4 5.2-21.2-.7L320 288l238.4 0z'/%3E%3C/svg%3E">
    <style>
        {{ inline_css }}
    </style>
</head>

<body>
    <svg class="d-none">
        <defs>
            <svg id="arrow-up-right-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm5.854 8.803a.5.5 0 1 1-.708-.707L9.243 6H6.475a.5.5 0 1 1 0-1h3.975a.5.5 0 0 1 .5.5v3.975a.5.5 0 1 1-1 0V6.707z"/>
            </svg>
            <svg id="arrow-up-right" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M14 2.5a.5.5 0 0 0-.5-.5h-6a.5.5 0 0 0 0 1h4.793L2.146 13.146a.5.5 0 0 0 .708.708L13 3.707V8.5a.5.5 0 0 0 1 0z"/>
</svg>
        </defs>
    </svg>
    <header class="container text-center">
        <h1 class="my-4">Cashflows</h1>
        <h5>{{ account_name }}, {{ start_date }} bis {{ end_date }}</h5>
        <p>
            Das folgende <a class="icon-link" href="https://de.wikipedia.org/wiki/Sankey-Diagramm" target="_blank" rel="external noopener">Sankey Chart<svg class="bi" aria-hidden="true"><use xlink:href="#arrow-up-right"></use></svg></a>
            zeigt die aus <a class="icon-link" href="https://moneymoney-app.com/" target="_blank" rel="external noopener">MoneyMoney<svg class="bi" aria-hidden="true"><use xlink:href="#arrow-up-right"></use></svg></a> exportierten Cashflows des
            <strong>Kontos {{ account_name }} ({{ account_number }})</strong> für den <strong>Zeitraum {{ start_date }} bis {{ end_date }}</strong>.<br>
            Es wurde aus insgesamt <strong id="transactionCount">{{ transaction_count }} Transaktionen</strong> generiert.
        </p>

        <button class="btn btn-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasConfig" aria-controls="offcanvasConfig">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
                <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
            </svg>
            Chart anpassen
        </button>
    </header>

    <main>
        <section id="sankey" class="row">
            <h2 class="visually-hidden">Sankey Chart</h2>
            <div id="chart-container"></div>
        </section>
    </main>

    <footer class="container text-center text-opacity-25 text-secondary p-3">
        <small>
            Dieser Bericht wurde am {{ today }} Uhr mit der MoneyMoney Extension
            <a href="https://github.com/ma4nn/moneymoney-sankey" target="_blank" class="text-opacity-25 text-secondary">moneymoney-sankey</a> Version v{{ version }} generiert.
        </small>
    </footer>


    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasConfig" aria-labelledby="offcanvasConfigLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasConfigLabel">Konfiguration</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <p>Hier kann das Sankey-Chart angepasst werden.</p>
            <form>
                <div class="row g-3">
                    <div class="col-12">
                        <label for="categories">Kategorie ausschließen</label>
                        <select id="categories" class="form-select" multiple aria-label="multiple select">
                        </select>
                    </div>
                    <div class="col-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="isShowMonthlyValues">
                            <label class="form-check-label" for="isShowMonthlyValues">Werte auf Monatsbasis anzeigen</label>
                        </div>
                    </div>
                    <div class="col-12">
                        <button id="applySettingsButton" type="submit" class="btn btn-primary" data-bs-dismiss="offcanvas">Anwenden</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        {{ inline_js }}

        let chartDataTree = new Tree(1, 0);
        {{ init_chart_js }}
        ready(() => window.chart = createChart(chartDataTree, new Map([{{ categories_json }}]), {{ number_of_months }}, '{{ currency }}'));
    </script>
</body>
</html>